# 关键点
## docker为何可以把镜像做的很小
1. 联合文件系统
    - 联合文件系统可以将各个镜像中重复的层复用，使得无需重复设置文件。
    - 如：MySQL和apache都安装在centos上，则在二者的镜像中centos是复用的。因此也可以发现在下载过程中镜像是分层下载的。
2. 必要部分
    - 系统需要引导程序，而对于docker则不需要，因为其差别不大。因此镜像的引导程序被精简了。
    - 而且，其内容也是十分精简的，如vim等软件其中都没有
3. 镜像使用系统的内核（kernel）

## docker联合文件系统关键
1. 文件修改作为一次提交
2. 打包的镜像会把上层的文件替换下层冲突的文件。（ps:就是在下载打包的镜像时，是获取不到历史版本的！)
3. 基础镜像都是只读层，在镜像的操作会在新创建的可写层中。
    - 这里的只读层就是镜像层，可写层就是容器层

## 容器数据卷
- 希望数据独立，持久化。
    + docker打包应用和环境
    + 希望容器之间可以数据共享
    + 即将数据同步到本地
- 卷技术：目录的挂载，将容器内的目录挂载在Linux上
```bash
docker run -v 主机文件夹位置:容器文件夹位置
```
### 具名挂载与匿名挂载
```bash
docker run -d -P nginx01 -v /etc/nginx
# 匿名挂载，此处未指定容器外宿主机的卷位置，此时生成的卷对应哈希值
docker run -d -P nginx02 -v nginx_jump:/etc/nginx
# 具名挂载，此处在挂载路径之前加了个名称（不以 ‘/’ 开头，因此为名称而非路径）
# 此时生成的卷对应名称
```
**若挂载的时候没有指定宿主机路径，则都默认在`/var/lib/docker/volumes/卷名/_data`下**
实际上，匿名挂载即挂载的路径在默认路径下的卷名是哈希值。具名挂载是自己取的名字。因此指定路径挂载和具名挂载很少一起提。
```bash
-v 容器内路径[:(ro|rw)]     #
-v 卷名:容器内路径
-v 宿主机路径:容器内路径    # 
```